<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>iOS设计模式学习---装饰模式 &#8211; Morisunshine's Blog</title>
<meta name="description" content="装饰模式（Decorator），动态地为一个对象添加额外的职责，是继承的替代方案，属于结构型模式。通过装饰模式扩展对象的功能比继承子类方式更灵活，使用继承子类的方式，是在编译时静态决定的，即编译时绑定，而且所有的子类都会继承相同的行为。然而，如果使用组合的方式扩展对象的行为，就可以在运行时动态地进行扩展，将来如果需要也可以动态的撤销，而不会影响原类的行为。">
<meta name="keywords" content="iOS">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://morisunshine.com/images/">
<meta name="twitter:title" content="iOS设计模式学习---装饰模式">
<meta name="twitter:description" content="装饰模式（Decorator），动态地为一个对象添加额外的职责，是继承的替代方案，属于结构型模式。通过装饰模式扩展对象的功能比继承子类方式更灵活，使用继承子类的方式，是在编译时静态决定的，即编译时绑定，而且所有的子类都会继承相同的行为。然而，如果使用组合的方式扩展对象的行为，就可以在运行时动态地进行扩展，将来如果需要也可以动态的撤销，而不会影响原类的行为。">
<meta name="twitter:creator" content="@morisunshine">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS设计模式学习---装饰模式">
<meta property="og:description" content="装饰模式（Decorator），动态地为一个对象添加额外的职责，是继承的替代方案，属于结构型模式。通过装饰模式扩展对象的功能比继承子类方式更灵活，使用继承子类的方式，是在编译时静态决定的，即编译时绑定，而且所有的子类都会继承相同的行为。然而，如果使用组合的方式扩展对象的行为，就可以在运行时动态地进行扩展，将来如果需要也可以动态的撤销，而不会影响原类的行为。">
<meta property="og:url" content="http://morisunshine.com/ios/ios_decorator/">
<meta property="og:site_name" content="Morisunshine's Blog">





<link rel="canonical" href="http://morisunshine.com/ios/ios_decorator/">
<link href="http://morisunshine.com/feed.xml" type="application/atom+xml" rel="alternate" title="Morisunshine's Blog Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://morisunshine.com/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://morisunshine.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://morisunshine.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://morisunshine.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://morisunshine.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://morisunshine.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://morisunshine.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://morisunshine.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<link rel="stylesheet" href="/assets/css/solarized_dark.css">

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://morisunshine.com">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://morisunshine.com/images/avatar.png" alt="Sheldon photo" class="author-photo">
					<h4>Sheldon</h4>
					<p>1991-12-10</p>
				</li>
				<li><a href="http://morisunshine.com/about/">Know More</a></li>
				<li>
					<a href="mailto:sheldon.zen@gmail.com"><i class="icon-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/morisunshine"><i class="icon-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://weibo.com/u/1626743220"><i class="icon-weibo"></i> Weibo</a>
				</li>
				
				
				<li>
					<a href="http://linkedin.com/in/morisunshine"><i class="icon-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/morisunshine"><i class="icon-github"></i> GitHub</a>
				</li>
				<li>
					<a href="http://stackoverflow.com/users/2194236/morisunshine"><i class="icon-stackexchange"></i> Stackexchange</a>
				</li>
				<li>
					<a href="http://instagram.com/morisunshine"><i class="icon-instagram"></i> Instagram</a>
				</li>
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://morisunshine.com/posts/">All Posts</a></li>
				<li><a href="http://morisunshine.com/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://morisunshine.com/feed">Feed</a></li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<style type="text/css">body {background-image:url(/images/witewall_3.png);}</style>

<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://morisunshine.com/ios/ios_decorator/" rel="bookmark" title="iOS设计模式学习---装饰模式">iOS设计模式学习---装饰模式</a></h1>
        
        <h2>July 14, 2013</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h2>定义</h2>

<p>装饰模式（Decorator），动态地为一个对象添加额外的职责，是继承的替代方案，属于结构型模式。通过装饰模式扩展对象的功能比继承子类方式更灵活，使用继承子类的方式，是在编译时静态决定的，即编译时绑定，而且所有的子类都会继承相同的行为。然而，如果使用组合的方式扩展对象的行为，就可以在运行时动态地进行扩展，将来如果需要也可以动态的撤销，而不会影响原类的行为。<br>
<img src="/images/2013-7-14.jpg" alt="图片">  </p>

<h2>实例</h2>

<p>接下来，通过Object-C来实践一下，我设想一个场景，用Decorator模式来实现一下对某个手机的GPS和蓝牙功能扩展
首先，我们需要一个手机的接口或者抽象类，我这里就用抽象类来实现，代码如下：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc">@interface AbstractCellPhone : NSObject
- (NSString *)callNumber;
- (NSString *)sendMessage;
@end
</code></pre></div><div class="highlight"><pre><code class="objc language-objc" data-lang="objc">#import &quot;AbstractCellPhone.h&quot;

@implementation AbstractCellPhone

- (NSString *)callNumber
{
    return @&quot;phone call somebody&quot;;
}

- (NSString *)sendMessage
{
    return @&quot;phone send a message to somebody&quot;;
}
@end
</code></pre></div>
<p>AbstractCellPhone也就是结构图中的Component，然后，我再来实现Nokia和Moto的手机类，这类要继承AbstractCellPhone，也就是图中ConcreteComponent类要继承Component，实现代码如下：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;AbstractCellPhone.h&quot;   
@interface NokiaPhone : AbstractCellPhone
@end

</code></pre></div><div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;NokiaPhone.h&quot;

@implementation NokiaPhone

- (NSString *)callNumber
{
    return @&quot;NokiaPhone call somebody&quot;;
}

- (NSString *)sendMessage
{
    return @&quot;NokiaPhone send Message to Somebody&quot;;
}

@end

</code></pre></div>
<p>接下来我需要一个Decorator接口或者抽象类，实现代码如下：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;AbstractCellPhone.h&quot;

@interface Decorator : AbstractCellPhone
{
@protected AbstractCellPhone *abstractCellPhone;
}
-(void)SetComponents:(Components*)component;
@end

</code></pre></div><div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;Decorator.h&quot;

@implementation Decorator
-(void)SetComponents:(Components*)component{
    components = component;
}

- (NSString *)callNumber
{
    return components.callNumber;
}

- (NSString *)sendMessage
{
    return components.sendMessage;
}
@end

</code></pre></div>
<p>正如结构图中，这个Decorator即继承了AbstractCellPhone，又包含了一个私有的AbstractCellPhone的对象。这样做的意义是：Decorator类又使用了另外一个Component类。我们可以使用一个或多个Decorator对象来“装饰”一个Component对象，且装饰后的对象仍然是一个Component对象。在下来，我要实现GSP和蓝牙的功能扩展，它们要继承自Decorator，代码如下：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;Decorator.h&quot;

@interface DecoratorGPS : Decorator

@end

</code></pre></div><div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
#import &quot;DecoratorGPS.h&quot;

@implementation DecoratorGPS

- (NSString *)callNumber
{
    return [NSString stringWithFormat:@&quot;%@ with GPS&quot;, [super callNumber]];
}

- (NSString *)sendMessage
{
    return [NSString stringWithFormat:@&quot;%@ with GPS&quot;, [super sendMessage]];
}

@end

</code></pre></div>
<p>最后，用客户端程序验证一下：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc">
int main(int argc, const char *argv[])
{
    @autoreleasepool {

        Components *phone = [[ConcreteComponent alloc] init];
        NSLog(@&quot;%@&quot;,phone.callNumber);
        NSLog(@&quot;%@&quot;,phone.sendMessage);
        ConcreteDecoratorA *GPS = [[ConcreteDecoratorA alloc] init];
        [GPS SetComponents:phone];
        NSLog(@&quot;%@&quot;,GPS.callNumber);
        NSLog(@&quot;%@&quot;,GPS.sendMessage);
        ConcreteDecoratorB *bluetooth = [[ConcreteDecoratorB alloc] init];
        [bluetooth SetComponents:phone];
        NSLog(@&quot;%@&quot;,bluetooth.callNumber);
        NSLog(@&quot;%@&quot;,bluetooth.sendMessage);
    }
    return 0;
}

</code></pre></div>
<p>执行结果：</p>
<div class="highlight"><pre><code class="objc language-objc" data-lang="objc"> NokiaPhone call somebody
 NokiaPhone send Message to Somebody
 NokiaPhone call somebody with GPS
 NokiaPhone send Message to Somebody with GPS
 NokiaPhone call somebody with BlueTooth
 NokiaPhone send Message to Somebody with BlueTooth

</code></pre></div>
      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://morisunshine.com/tags/#iOS" title="Pages tagged iOS" class="tag">iOS</a></span>
        <span><a href="http://morisunshine.com/ios/ios_decorator/" rel="bookmark" title="iOS设计模式学习---装饰模式">iOS设计模式学习---装饰模式</a> was published on <span class="entry-date date published updated"><time datetime="2013-07-14T00:00:00+08:00">July 14, 2013</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>
        <div class="social-share">
          <ul class="socialcount socialcount-small inline-list">
            <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://morisunshine.com/ios/ios_decorator/" title="Share on Facebook"><span class="count"><i class="icon-facebook-sign"></i> Like</span></a></li>
            <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://morisunshine.com/ios/ios_decorator/" title="Share on Twitter"><span class="count"><i class="icon-twitter-sign"></i> Tweet</span></a></li>
            <li class="googleplus"><a href="https://plus.google.com/share?url=http://morisunshine.com/ios/ios_decorator/" title="Share on Google Plus"><span class="count"><i class="icon-google-plus-sign"></i> +1</span></a></li>
            <li class="weibo"><a href="http://v.t.sina.com.cn/share/share.php?title=http://morisunshine.com/ios/ios_decorator/" title="Share on Weibo"><span class="count"><i class="icon-weibo"></i>weibo</spac></a></li>
          </ul>
        </div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    <section id="disqus_thread">
      <!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"morisunshne"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->
    </section>
    <!-- /#disqus_thread -->
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="http://morisunshine.com/life/travel-to-qinghai/" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="http://morisunshine.com/%E5%AD%A6%E4%B9%A0/thiking_of_study/" title="关于学习的一些思考">关于学习的一些思考</a></h3>
          <p>最近一直在思考，这也是我去年一直在困惑的问题。自从开始工作，就发现了自己知识的匮乏，很多朋友的一些随机的提问就让我不知所措，有时我会微笑以对，表面上不放在心上，以“自己还年轻，不可能什么都知道”来安慰自己，但是还是会暗下决心，要多看书，多学习知识。今年开始，我也确实是这么做的，但是效果不是很明显，我知道我有很多东西要学，但是首先没有很多时间去认真研读，比如有些知识并不是看过就能掌握，第一次读完之后可能还是会不知所云，第二次再阅读时才可能有更深入的理解，但总是害怕花这样的时间去做这样的事情，以为这样的重复会浪费时间，但是遇到别的轻松的事情时却很愿意花时间，甚至挥霍时间，直到自己意识到这样是不可以的，比如看电视剧。所以这也暴露出我的一个问题，就是我对自己的自控能力不足，总是会以各种接口去推脱，但是这些问题依然是要去面对。 <a href="http://morisunshine.com/%E5%AD%A6%E4%B9%A0/thiking_of_study/">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="http://morisunshine.com/ios/replicating_uiscrollviews_deceleration_with_facebook/" title="使用FaceceBook 的Pop框架替换UIScrollView的减速动画">使用FaceceBook 的Pop框架替换UIScrollView的减速动画</a></h4>
            <span>Published on June 10, 2014</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="http://morisunshine.com/reading/the_art_of_readable_code/" title="《编写可读代码的艺术》读书笔记">《编写可读代码的艺术》读书笔记</a></h4>
            <span>Published on June 02, 2014</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Sheldon. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://morisunshine.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://morisunshine.com/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-47868064-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script src="/assets/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

	        

</body>
</html>
