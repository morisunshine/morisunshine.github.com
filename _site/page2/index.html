<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Just for fun &#8211; Morisunshine's Blog</title>
<meta name="description" content="Describe this nonsense.">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://morisunshine.com/images/header_bg.jpg">

<meta name="twitter:title" content="Just for fun">
<meta name="twitter:description" content="Describe this nonsense.">
<meta name="twitter:creator" content="@morisunshine">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Just for fun">
<meta property="og:description" content="Describe this nonsense.">
<meta property="og:url" content="http://morisunshine.com/page2/index.html">
<meta property="og:site_name" content="Morisunshine's Blog">





<link rel="canonical" href="http://morisunshine.com/page2/">
<link href="http://morisunshine.com/feed.xml" type="application/atom+xml" rel="alternate" title="Morisunshine's Blog Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://morisunshine.com/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://morisunshine.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://morisunshine.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://morisunshine.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://morisunshine.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://morisunshine.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://morisunshine.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://morisunshine.com/images/apple-touch-icon-144x144-precomposed.png">



</head>

<link rel="stylesheet" href="/assets/css/solarized_dark.css">

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://morisunshine.com">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://morisunshine.com/images/avatar.png" alt="Sheldon photo" class="author-photo">
					<h4>Sheldon</h4>
					<p>1991-12-10</p>
				</li>
				<li><a href="http://morisunshine.com/about/">Know More</a></li>
				<li>
					<a href="mailto:sheldon.zen@gmail.com"><i class="icon-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/morisunshine"><i class="icon-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://weibo.com/u/1626743220"><i class="icon-weibo"></i> Weibo</a>
				</li>
				
				
				<li>
					<a href="http://linkedin.com/in/morisunshine"><i class="icon-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/morisunshine"><i class="icon-github"></i> GitHub</a>
				</li>
				<li>
					<a href="http://stackoverflow.com/users/2194236/morisunshine"><i class="icon-stackexchange"></i> Stackexchange</a>
				</li>
				<li>
					<a href="http://instagram.com/morisunshine"><i class="icon-instagram"></i> Instagram</a>
				</li>
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://morisunshine.com/posts/">All Posts</a></li>
				<li><a href="http://morisunshine.com/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="http://morisunshine.com/feed">Feed</a></li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  
  
    <div class="entry-image">
      <img src="http://morisunshine.com/images/header_bg.jpg" alt="Just for fun">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Morisunshine's Blog</h1>
      <h2>Just for fun</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<style type="text/css">body {background-image:url(/images/witewall_3.png);}</style>

<div id="main" role="main">
  
<article class="hentry">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-04-22T00:00:00+08:00"><a href="http://morisunshine.com/ios/ios_code_standards/">April 22, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://morisunshine.com/ios/ios_code_standards/#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://morisunshine.com/ios/ios_code_standards/" rel="bookmark" title="iOS编码规范参考" itemprop="url">iOS编码规范参考</a></h1>
    
  </header>
  <div class="entry-description">经常说没有最好的风格，只有统一风格，所以编码规范就是为了统一我们的编码风格。而在这里我对我平时使用的编码规范进行了一个总结，希望能给大家提供参考</div>
  <div class="entry-content">
    <div class="full-text"><p>经常说没有最好的风格，只有统一风格，所以编码规范就是为了统一我们的编码风格。而在这里我对我平时使用的编码规范进行了一个总结，希望能给大家提供参考</p>

<h2>注释</h2>

<p>建议使用<a href="https://github.com/onevcat/VVDocumenter-Xcode">VVDocumenter</a>插件</p>

<h3>多行注释</h3>

<p>格式:</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="cm">/**</span>

<span class="cm">              注释内容</span>
<span class="cm">*/</span>
</code></pre></div>
<h3>单行注释</h3>

<p>格式:</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">///在对文件、类、函数进行注释时推荐使用多行注释，在函数体内对代码块进行注释时，使用单行注释</span>
</code></pre></div>
<h3>函数的注释</h3>

<p>函数注释的格式为</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="cm">/**</span>
<span class="cm"> *  @brief  </span>
<span class="cm"> *  @param</span>
<span class="cm"> *  @return</span>
<span class="cm"> **/</span>
 <span class="err">在</span><span class="n">brief</span><span class="err">中需要写明函数的主要功能、注意事项</span>
 <span class="err">在</span><span class="n">param</span><span class="err">中需要写明函数的变量类型、变量的作用</span>
 <span class="err">在</span><span class="k">return</span><span class="err">中需要写明函数的返回类型、返回值的作用</span>
 <span class="err">如有其他需要说明的地方，可以在</span><span class="p">@</span><span class="k">return</span><span class="err">后面添加新项。如</span>
 <span class="cm">/**</span>
<span class="cm"> *  @brief  </span>
<span class="cm"> *  @param</span>
<span class="cm"> *  @return</span>
<span class="cm"> *  @warning</span>
<span class="cm"> **/</span>

<span class="cm">/**</span>
<span class="cm"> *  @brief      上传图片。上传成功后会自动将图片放入缓存，缓存的key为图片的url</span>
<span class="cm"> *  @param      UIImage，需要上传的图片</span>
<span class="cm"> *  @return     void</span>
<span class="cm"> *  @blocks</span>
<span class="cm"> *              success:返回的NSDictionary中包含服务器的response信息，包括图片id（id）,url(url),宽度(width),高度(height)。使用括号中的名称从NSDictionary中获取。</span>
<span class="cm"> *              failed:返回error</span>
<span class="cm"> **/</span>
</code></pre></div>
<h2>命名</h2>

<h3>常量的命名</h3>

<p>(如宏、枚举、静态局部变量等)应该以小写字母k开头，使用混合大小写的格式来分隔单词。</p>

<h3>函数的命名</h3>

<p>函数名应该已小写字母开头，并混合大小写，其中的每个参数都应该是小写字母开头，读起来应该像句子一样，访问器方法应该与他们getting的成员变量的名字一样，但不应该以get作为前缀，如：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc">  <span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">getDelegate</span><span class="p">;</span>    <span class="c1">//avoid</span>
  <span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">delegate</span><span class="p">;</span>       <span class="c1">//good</span>
</code></pre></div>
<h3>变量的命名</h3>

<p>成员变量应该已小写字母开头，并以下划线作为后缀，如usernameTextField_,使用KVO/KVC绑定成员变量时，可以以一个下划线为前缀。</p>

<blockquote>
<p>公共变量命名:
小写字母开头。如:imageView;</p>

<p>实例变量命名:</p>

<p>私有变量:
应该以下划线开头。如:_addButton</p>

<p>常量命名:
以小写k开头，混合大小写。如:kInvalidHandle, kWritePerm</p>
</blockquote>

<h3>图片的命名</h3>

<p>应该已“模块+功能+作用+样式”的形式</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span><span class="n">message_private_at_button_bg_normal</span><span class="p">.</span><span class="n">png</span>
</code></pre></div>
<h3>类的命名</h3>

<p>类名、分类名、协议名应该以大写字母开始，并混合小写字母来分隔单词，应该已“模块+功能+子功能”的方式：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span><span class="n">MessagePrivateAtsomebody</span>
</code></pre></div>
<p>应用级的类，应避免不用前缀，跨应用级的类，应使用前缀，
<code>objc
如:GTMSendMessage
</code></p>

<h2>分类名</h2>

<p>类别名应该有两三个字母作为前缀已表示为某项目的一部分，并且包含所扩展的类的名字，如我们要创建一个NSString的类别以解析，我们将类别放在一个名为GTMNSString+Parsing.h的文件中。类别名本身为GTMStringParsingAdditions(类别名与文件名不同是为了让文件可以包含更多相同功能的扩展)类名与包含类别名之间应一个空格分隔。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="c1">//NSString 为要扩展的类名, GTMStringParsingAdditions为类别名</span>
<span class="k">@interface</span> <span class="bp">NSString</span> <span class="nl">(GTMStringParsingAdditions)</span>
        <span class="o">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">gtm_foobarString</span><span class="p">;</span>
        <span class="k">@end</span>

        <span class="k">@interface</span> <span class="nc">FoobarViewController</span> <span class="p">()</span>
        <span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">retain</span><span class="p">)</span> <span class="n">NSView</span> <span class="o">*</span><span class="n">dongleView</span><span class="p">;</span>
        <span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">performLayout</span><span class="p">;</span>
        <span class="k">@end</span>
</code></pre></div>
<h2>注意事项</h2>

<h3>条件语句</h3>

<p>为避免错误，条件语句体必须使用大括号，即便语句体中的语句可以不必使用大括号（比如只有一行语句）。常见的错误包括在不使用大括号的情况下添加第二行语句，以为它属于if语句的一部分。此外，更可怕的事情是，如果条件语句中的代码行被注释，则本不术语条件语句的下一行代码将变成条件语句的一部分。此外，这种编码风格和所有其它条件语句均保持一致。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">success</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3>变量</h3>

<p>变量的命名应尽可能具有自解释性。除了在for()循环语句中，应避免使用单个字母变量名称。
除非是常量，星号应紧贴变量名称表示指向变量的指针，
<code>objc
如:
NSString *text;
</code></p>

<p>应尽可能使用属性定义替代单一的实例变量。避免在初始化方法,dealloc方法和自定义的setter和getter方法中直接读取实例变量参数（init,initWithCoder:，等等）</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">@interface</span> <span class="nc">NYTSection</span>: <span class="bp">NSObject</span>

<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">headline</span><span class="p">;</span>

<span class="k">@end</span>

<span class="err">应尽量避免下面的方式</span><span class="o">:</span>

<span class="k">@interface</span> <span class="nc">NYTSection</span> : <span class="bp">NSObject</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">headline</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3>下划线</h3>

<p>当使用属性变量时，应通过self.来获取和更改实例变量。这就意味着所有的属性将是独特的，因为它们的名称前会加上self。本地变量名称中不应包含下划线</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="nb">self</span><span class="p">.</span><span class="n">imgView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">black</span><span class="p">];</span>

<span class="err">而尽量避免</span><span class="o">:</span>

<span class="n">_imgView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">black</span><span class="p">];</span>
</code></pre></div>
<h3>Immutable实例初始化</h3>

<p>在创建NSString,NSDictionary,NSArray和NSNumber等对象的immutable实例时，应使用字面量。需要注意的是，不应将<strong><em>nil</em></strong>传递给NSArray和NSDictionary字面量，否则会引起程序崩溃。所以在存入数据到NSArray和NSDictionary时也要判断一下数据是否是nil。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="bp">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="l">@[</span><span class="s">@&quot;Brian&quot;</span><span class="p">,</span> <span class="s">@&quot;Matt&quot;</span><span class="p">,</span> <span class="s">@&quot;Chris&quot;</span><span class="p">,</span> <span class="s">@&quot;Alex&quot;</span><span class="p">,</span> <span class="s">@&quot;Steve&quot;</span><span class="p">,</span> <span class="s">@&quot;Paul&quot;</span><span class="l">]</span><span class="p">;</span>
<span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">productManagers</span> <span class="o">=</span> <span class="l">@{</span><span class="s">@&quot;iPhone&quot;</span> <span class="o">:</span> <span class="s">@&quot;Kate&quot;</span><span class="p">,</span> <span class="s">@&quot;iPad&quot;</span> <span class="o">:</span> <span class="s">@&quot;Kamal&quot;</span><span class="p">,</span> <span class="s">@&quot;Mobile Web&quot;</span> <span class="o">:</span> <span class="s">@&quot;Bill&quot;</span><span class="l">}</span><span class="p">;</span>
<span class="bp">NSNumber</span> <span class="o">*</span><span class="n">shouldUseLiterals</span> <span class="o">=</span> <span class="m">@YES</span><span class="p">;</span>
<span class="bp">NSNumber</span> <span class="o">*</span><span class="n">buildingZIPCode</span> <span class="o">=</span> <span class="mi">@10018</span><span class="p">;</span>

<span class="err">不恰当</span><span class="o">:</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSArray</span> <span class="nl">arrayWithObjects</span><span class="p">:</span><span class="s">@&quot;Brian&quot;</span><span class="p">,</span> <span class="s">@&quot;Matt&quot;</span><span class="p">,</span> <span class="s">@&quot;Chris&quot;</span><span class="p">,</span> <span class="s">@&quot;Alex&quot;</span><span class="p">,</span> <span class="s">@&quot;Steve&quot;</span><span class="p">,</span> <span class="s">@&quot;Paul&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];</span>
<span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">productManagers</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDictionary</span> <span class="nl">dictionaryWithObjectsAndKeys</span><span class="p">:</span> <span class="s">@&quot;Kate&quot;</span><span class="p">,</span> <span class="s">@&quot;iPhone&quot;</span><span class="p">,</span> <span class="s">@&quot;Kamal&quot;</span><span class="p">,</span> <span class="s">@&quot;iPad&quot;</span><span class="p">,</span> <span class="s">@&quot;Bill&quot;</span><span class="p">,</span> <span class="s">@&quot;Mobile Web&quot;</span><span class="p">,</span> <span class="nb">nil</span><span class="p">];</span>
<span class="bp">NSNumber</span> <span class="o">*</span><span class="n">shouldUseLiterals</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithBool</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="bp">NSNumber</span> <span class="o">*</span><span class="n">ZIPCode</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithInteger</span><span class="p">:</span><span class="mi">10018</span><span class="p">];</span>
</code></pre></div>
<h3>类型</h3>

<p>最好用NSInteger和NSUInteger而不是用int，long。其他的float同理。</p>

<h3>CGRect函数</h3>

<p>当需要获取一个CGRect矩形的x,y,width,height属性时，应使用CGGeometry函数，而非直接访问结构体成员。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如：</span>
<span class="bp">CGRect</span> <span class="n">frame</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">;</span>

<span class="n">CGFloat</span> <span class="n">x</span> <span class="o">=</span> <span class="n">CGRectGetMinX</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>
<span class="n">CGFloat</span> <span class="n">y</span> <span class="o">=</span> <span class="n">CGRectGetMinY</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>
<span class="n">CGFloat</span> <span class="n">width</span> <span class="o">=</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>
<span class="n">CGFloat</span> <span class="n">height</span> <span class="o">=</span> <span class="n">CGRectGetHeight</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>

<span class="err">不恰当：</span>
<span class="bp">CGRect</span> <span class="n">frame</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">;</span>

<span class="n">CGFloat</span> <span class="n">x</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="n">CGFloat</span> <span class="n">y</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
<span class="n">CGFloat</span> <span class="n">width</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span>
<span class="n">CGFloat</span> <span class="n">height</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
</code></pre></div>
<h3>常量</h3>

<p>相对字符串字面量或数字，我们更推荐适用常量。应使用static方式声明常量，而非使用#define的方式来定义宏。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">例如：</span>
<span class="k">static</span> <span class="bp">NSString</span> <span class="o">*</span> <span class="k">const</span> <span class="n">NYTAboutViewControllerCompanyName</span> <span class="o">=</span> <span class="s">@&quot;The New York Times Company&quot;</span><span class="p">;</span>  
<span class="k">static</span> <span class="k">const</span> <span class="n">CGFloat</span> <span class="n">NYTImageThumbnailHeight</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">;</span>

<span class="err">不恰当</span><span class="o">:</span>
<span class="c1">//#define CompanyName @&quot;The New York Times Company&quot;</span>
<span class="c1">//#define thumbnailHeight 2</span>
</code></pre></div>
<h3>枚举类型</h3>

<p>在使用enum的时候，推荐适用最新的fixed underlying type(WWDC 2012 session 405- Modern Objective-C)规范，因为它具备更强的类型检查和代码完成功能。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如：</span>
<span class="k">typedef</span> <span class="n">NS_ENUM</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">,</span> <span class="n">NYTAdRequestState</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NYTAdRequestStateInactive</span><span class="p">,</span>
    <span class="n">NYTAdRequestStateLoading</span>
<span class="p">};</span>
</code></pre></div>
<h3>布尔变量</h3>

<p>因为nil将被解析为NO，因此没有必要在条件语句中进行比较。永远不要将任何东西和YES进行直接比较，因为YES被定义为1，而一个BOOL变量可以有8个字节。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如：</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">someObject</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">isAwesome</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">someObject</span> <span class="n">boolValue</span><span class="p">])</span>

<span class="err">不恰当：</span>
<span class="k">if</span> <span class="p">(</span><span class="n">someObject</span> <span class="o">==</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">([</span><span class="n">someObject</span> <span class="n">boolValue</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NO</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">isAwesome</span> <span class="o">==</span> <span class="nb">YES</span><span class="p">)</span> <span class="c1">// Never do this.</span>
</code></pre></div>
<p>如果一个BOOL属性使用形容词来表达，属性将忽略’is’前缀，但会强调惯用名称。
例如：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">@property</span> <span class="p">(</span><span class="k">assign</span><span class="p">,</span> <span class="k">getter</span><span class="o">=</span><span class="n">isEditable</span><span class="p">)</span> <span class="kt">BOOL</span> <span class="n">editable</span><span class="p">;</span>
</code></pre></div>
<h3>单例</h3>

<p>在创建单例对象的共享实例时，应使用线程安全模式。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如：</span>
<span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="n">sharedInstance</span> <span class="p">{</span>
   <span class="k">static</span> <span class="kt">id</span> <span class="n">sharedInstance</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>

   <span class="k">static</span> <span class="kt">dispatch_once_t</span> <span class="n">onceToken</span><span class="p">;</span>
   <span class="n">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">onceToken</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span>
      <span class="n">sharedInstance</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">self</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
   <span class="p">});</span>

   <span class="k">return</span> <span class="n">sharedInstance</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3>数字</h3>

<p>尽量避免数字固定为某个类型如:写5而不写5.0，5.3而不写5.3f)</p>

<h3>代码组织</h3>

<p>用 <code>#pragma mark</code>来将方法分类，这个非常有效，当你用快捷键<code>Control+6</code>可以高效的寻找到自己想要跳转到的方法</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">//#pragma mark Properties</span>

<span class="k">@dynamic</span> <span class="n">someProperty</span><span class="p">;</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setCustomProperty:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">value</span> <span class="p">{}</span>

<span class="cp">#pragma mark Lifecycle</span>

<span class="p">+</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">objectWithThing:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">thing</span> <span class="p">{}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span> <span class="p">{}</span>

<span class="cp">#pragma mark Drawing</span>

<span class="cp">#pragma mark UItableView delegate</span>

<span class="cp">#pragma mark UITableView datasource</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect:</span><span class="p">(</span><span class="bp">CGRect</span><span class="p">)</span> <span class="p">{}</span>

<span class="cp">#pragma mark Another functional grouping</span>

<span class="cp">#pragma mark GHSuperclass</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">someOverriddenMethod</span> <span class="p">{}</span>

<span class="cp">#pragma mark NSCopying</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nl">copyWithZone</span><span class="p">:(</span><span class="n">NSZone</span> <span class="o">*</span><span class="p">)</span><span class="n">zone</span> <span class="p">{}</span>

<span class="cp">#pragma mark NSObject</span>

<span class="o">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">description</span> <span class="p">{}</span>
</code></pre></div>
<h3>判断语句</h3>

<p>if和else应该和左大括号在同一行</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">if</span> <span class="p">(</span><span class="n">button</span><span class="p">.</span><span class="n">enabled</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Stuff</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">otherButton</span><span class="p">.</span><span class="n">enabled</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Other stuff</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// More stuf</span>
<span class="p">}</span>
</code></pre></div>
<p>Switch 也是一样</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">switch</span> <span class="p">(</span><span class="n">something</span><span class="p">.</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// Something</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// Something</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// Something</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">default</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// Something</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3>Import</h3>

<p>在类的头文件中需要引用其他的类的时候，需要用<code>@class</code>这个关键字，这样能减少类与类之间的依赖。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="n">store</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span>

<span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>
<span class="cp">#import &lt;CoreData/CoreData.h&gt;</span>

<span class="k">@class</span> <span class="nc">User</span>;

<span class="k">@interface</span> <span class="nc">Store</span> : <span class="bp">NSManagedObject</span>

<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">retain</span><span class="p">)</span> <span class="n">User</span> <span class="o">*</span><span class="n">user</span><span class="p">;</span>

<span class="k">@end</span>

<span class="n">Store</span><span class="p">.</span><span class="nl">m</span><span class="p">:</span>

<span class="cp">#import &quot;Store.h&quot;</span>

<span class="cp">#import &quot;User.h&quot;</span>

<span class="k">@implementation</span> <span class="nc">Store</span>

<span class="c1">//doSomething</span>

<span class="k">@end</span>
</code></pre></div>
<h3>私有方法</h3>

<p>关于私有方法，苹果官方建议呢是是使用统一的前缀来分组和辨识。但是千万不用用下划线来作为前缀来命名，或者你可以在前缀前添加一些特殊的标识。</p>

<h2>git commit 格式</h2>

<p>可以参考<a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#">google开源项目的Commit 规范</a></p>

<p>参考规范:</p>

<ol>
<li><strong>添加了新功能</strong> <code>feat(大模块+子模块):#例如实现了某个具体功能</code></li>
<li><strong>修改了某些功能</strong>  <code>change(大模块+子模块):#例如修改了某个具体的功能</code></li>
<li><strong>修复了某个Bug</strong>  <code>fix_bug(大模块+子模块):#修复了什么的bug，最好写上*原因*和*解决方法*。</code></li>
<li><strong>比较大的改动</strong>
```
broken_change():
before: </li>
</ol>

<p>after:
```</p>

<ol>
<li><strong>修改了文档</strong> <code>docs():</code></li>
<li><strong>修改了格式</strong> <code>style():</code></li>
<li><strong>添加了一些测试</strong> <code>test(大模块+子模块):</code></li>
<li><strong>一些杂项，比如像解决工程编译错误等问题之后的修改</strong> <code>chore():</code></li>
<li><strong>对又有代码的重构</strong> <code>refactor(大模块+子模块):</code></li>
</ol>

<h2>格式</h2>

<p>一行代码的长度不能超过80个字母</p>

<p><strong>函数声明和定义:</strong></p>

<p>“-”或“+”和返回类型之间应该有一个空格</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">doSomethingWithString</span><span class="p">:(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">theString</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>方法大括号和其它大括号（比如if/else/switch/while等等）应在语句的同一行开始，而在新的一行关闭。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">if</span> <span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">isHappy</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//Do something</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
<span class="c1">//Do something else</span>
<span class="p">}</span>
</code></pre></div>
<p>当有多个参数的时，如果参数太多超过一行，则应该将每个参数分行，并且冒号对齐</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">doSomethingWith</span><span class="p">:(</span><span class="n">GTMFoo</span> <span class="o">*</span><span class="p">)</span><span class="n">theFoo</span>
                   <span class="nl">rect</span><span class="p">:(</span><span class="n">NSRect</span><span class="p">)</span><span class="n">theRect</span>
               <span class="nl">interval</span><span class="p">:(</span><span class="kt">float</span><span class="p">)</span><span class="n">theInterval</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>当第一个参数短于其他参数的时候，分行时每行至少要缩进4个空格</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc">             <span class="nl">longKeyword</span><span class="p">:(</span><span class="n">NSRect</span><span class="p">)</span><span class="n">theRect</span>
       <span class="nl">evenLongerKeyword</span><span class="p">:(</span><span class="kt">float</span><span class="p">)</span><span class="n">theInterval</span>
                   <span class="nl">error</span><span class="p">:(</span><span class="bp">NSError</span> <span class="o">**</span><span class="p">)</span><span class="n">theError</span> <span class="p">{</span>
          <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<h3>方法调用</h3>

<p>方法调用应该和方法声明的时候一个格式,要么所有参数放在一行里:</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith</span><span class="p">:</span><span class="n">arg1</span> <span class="nl">name</span><span class="p">:</span><span class="n">arg2</span> <span class="nl">error</span><span class="p">:</span><span class="n">arg3</span><span class="p">];</span>
</code></pre></div>
<p>要么每一行一个参数:</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith</span><span class="p">:</span><span class="n">arg1</span>
               <span class="nl">name</span><span class="p">:</span><span class="n">arg2</span>
              <span class="nl">error</span><span class="p">:</span><span class="n">arg3</span><span class="p">];</span>
</code></pre></div>
<p>当第一个参数短语其他参数的时候，分行是每行至少要缩进4个空格:</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="p">[</span><span class="n">myObj</span> <span class="kt">short</span><span class="o">:</span><span class="n">arg1</span>
          <span class="nl">longKeyword</span><span class="p">:</span><span class="n">arg2</span>
    <span class="nl">evenLongerKeyword</span><span class="p">:</span><span class="n">arg3</span>
                <span class="nl">error</span><span class="p">:</span><span class="n">arg4</span><span class="p">];</span>
</code></pre></div>
<p>@public 和 @private前面为一个空格</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">@interface</span> <span class="nc">MyClass</span> : <span class="bp">NSObject</span><span class="p">{</span>
 <span class="k">@public</span>
 <span class="err">…</span>
 <span class="k">@private</span>
<span class="p">}</span>
<span class="k">@end</span>
</code></pre></div>
<h3>协议</h3>

<p>类型与协议名之间不要空格</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">如</span><span class="o">:</span>
<span class="k">@interface</span> <span class="nc">MyProtocoledClass</span> : <span class="nc">NsObject</span><span class="o">&lt;</span><span class="n">NSWindowDelegate</span><span class="o">&gt;</span> <span class="p">{</span>
 <span class="k">@private</span>
  <span class="kt">id</span><span class="o">&lt;</span><span class="n">MyFancyDelegate</span><span class="o">&gt;</span> <span class="n">_delegate</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span>  <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">setDelegate</span><span class="p">:(</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">MyFancyDelegate</span><span class="o">&gt;</span><span class="p">)</span><span class="n">aDelegate</span><span class="p">;</span>
<span class="k">@end</span>
</code></pre></div>
<h3>Blocks</h3>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="err">在一行的情况</span>
<span class="err">如</span><span class="o">:</span>
<span class="p">[</span><span class="n">operation</span> <span class="nl">setCompletionBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span> <span class="p">[</span><span class="nb">self</span> <span class="n">onOperationDone</span><span class="p">];</span> <span class="p">}];</span>

<span class="c1">//block 在新的行里，需要缩进四个空格</span>
<span class="p">[</span><span class="n">operation</span> <span class="nl">setCompletionBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
      <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">delegate</span> <span class="n">newDataAvailable</span><span class="p">];</span>
<span class="p">}];</span>

<span class="n">dispatch_async</span><span class="p">(</span><span class="n">_fileIOQueue</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span>
      <span class="bp">NSString</span><span class="o">*</span> <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="n">sessionFilePath</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
      <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="c1">//有参数的block,|(SessionWindow *window)|与|{|之间有一个空格</span>
<span class="err">如</span><span class="o">:</span>
<span class="p">[[</span><span class="n">SessionService</span> <span class="n">sharedService</span><span class="p">]</span>
    <span class="nl">loadWindowWithCompletionBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">SessionWindow</span> <span class="o">*</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
          <span class="p">[</span><span class="nb">self</span> <span class="nl">windowDidLoad</span><span class="p">:</span><span class="n">window</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="p">[</span><span class="nb">self</span> <span class="n">errorLoadingWindow</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}];</span>

<span class="c1">//block 中有参数且不能在一行中显示</span>
<span class="c1">//要行与行之间要相对有四个空格</span>
<span class="p">[[</span><span class="n">SessionService</span> <span class="n">sharedService</span><span class="p">]</span>
      <span class="nl">loadWindowWithCompletionBlock</span><span class="p">:</span>
            <span class="o">^</span><span class="p">(</span><span class="n">SessionWindow</span> <span class="o">*</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
                   <span class="k">if</span> <span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
                     <span class="p">[</span><span class="nb">self</span> <span class="nl">windowDidLoad</span><span class="p">:</span><span class="n">window</span><span class="p">];</span>
                   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                     <span class="p">[</span><span class="nb">self</span> <span class="n">errorLoadingWindow</span><span class="p">];</span>
                   <span class="p">}</span>
            <span class="p">}];</span>

<span class="c1">//很长的block可以被定义不在一行里</span>
<span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">largeBlock</span><span class="p">)(</span><span class="kt">void</span><span class="p">)</span> <span class="o">=</span> <span class="o">^</span><span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">};</span>
<span class="p">[</span><span class="n">_operationQueue</span> <span class="nl">addOperationWithBlock</span><span class="p">:</span><span class="n">largeBlock</span><span class="p">];</span>
</code></pre></div></div>
    <div class="collapse-text"></div>
    <div class="collapse-toggle"></div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-04-16T00:00:00+08:00"><a href="http://morisunshine.com/ios/Property_of_Objective_C/">April 16, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://morisunshine.com/ios/Property_of_Objective_C/#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://morisunshine.com/ios/Property_of_Objective_C/" rel="bookmark" title="@property中attribute的整理" itemprop="url">@property中attribute的整理</a></h1>
    
  </header>
  <div class="entry-description">assign:指定setter方法用简单的赋值，这是默认操作。你可以对标量类型（如int）使用这个属性。你可以想象一个float，它不是一个对象，所以它不能retain、copy。可以简单赋值，不更改索引计数(Reference Counting)。使用assign: 对基础数据类型 （NSInteger）和C数据类型（int, float, double, char,等）</div>
  <div class="entry-content">
    <div class="full-text"><p><code>assign</code>:指定setter方法用简单的赋值，这是默认操作。你可以对标量类型（如int）使用这个属性。你可以想象一个float，它不是一个对象，所以它不能retain、copy。可以简单赋值，不更改索引计数(Reference Counting)。使用assign: 对基础数据类型 （NSInteger）和C数据类型（int, float, double, char,等）</p>

<p><code>retain</code>:指定retain应该在后面的对象上调用，前一个值发送一条release消息。你可以想象一个NSString实例，它是一个对象，而且你可能想要retain它。
 释放旧的对象，将旧对象的值赋予输入对象，再提高输入对象的索引计数为1 ，使用retain： 对其他NSObject和其子类 ，retain，是说明该属性在赋值的时候，先release之前的值，然后再赋新值给属性，引用再加1。</p>

<p><code>copy</code>:指定应该使用对象的副本（深度复制），前一个值发送一条release消息。基本上像retain，但是没有增加引用计数，是分配一块新的内存来放置它。copy是创建一个新对象，retain是创建一个指针，引用对象计数加1。copy：建立一个索引计数为1的对象，然后释放旧对象，copy是创建一个新对象，retain是创建一个指针，引用对象计数加1。</p>

<p><code>readonly:</code>将只生成getter方法而不生成setter方法（getter方法没有get前缀)。</p>

<p><code>readwrite</code>:默认属性，将生成不带额外参数的getter和setter方法（setter方法只有一个参数）。</p>

<p><code>atomic</code>:对于对象的默认属性，就是setter/getter生成的方法是一个原子操作。如果有多个线程同时调用setter的话，不会出现某一个线程执行setter全部语句之前，另一个线程开始执行setter的情况，相关于方法头尾加了锁一样。</p>

<p><code>nonatomic</code>:不保证setter/getter的原子性，多线程情况下数据可能会有问题。nonatomic，非原子性访问，不加同步，多线程并发访问会提高性能。先释放原先变量，再将新变量retain然后赋值；</p>

<p><code>strong</code>:ARC中默认的方式是Strong，所以一般情况下，你是不需要写Strong的，strong关键字与retain关似，用了它，引用计数自动＋1。</p>

<p><code>weak</code>:weak所指向的指针顾名思义，只有很多的引用关系，当指向的内存地址被释放掉，weak指针也就会被释放掉了，这些指针都将被赋值为nil，这样的好处能有效的防止野指针</p>

<p><code>unsafe_unretained</code>:unsafe_unretained与weak有点类似，但是当所指向的指针被释放后，这些指针不会被赋值为nil，而成为野指针。</p>
</div>
    <div class="collapse-text"></div>
    <div class="collapse-toggle"></div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-03-24T00:00:00+08:00"><a href="http://morisunshine.com/life/live_in_the_moment/">March 24, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://morisunshine.com/life/live_in_the_moment/#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://morisunshine.com/life/live_in_the_moment/" rel="bookmark" title="活在当下" itemprop="url">活在当下</a></h1>
    
  </header>
  <div class="entry-description">经常有这样的困惑，觉得每天的时间都不够用，对未来做了很多计划，但最终总是证明“计划赶不上变化”，所以那些计划就这样被积压，或者被遗弃，感觉时间真是吝啬。但当自己拥有足够的时间时，却拖延症作祟，什么都不想动，只想坐在那里，什么都不想，让自己放空，但这时内心却是无比挣扎，很想打败拖延症，可是内心总有个懒散的声音在说“好不容易放个假，应该好好休息一下，看什么书啊，多累啊”，好吧，大多数时候总是信了他的话。</div>
  <div class="entry-content">
    <div class="full-text"><p><img src="/images/p2014_3_24.jpg" alt="图片"></p>

<p>经常有这样的困惑，觉得每天的时间都不够用，对未来做了很多计划，但最终总是证明“计划赶不上变化”，所以那些计划就这样被积压，或者被遗弃，感觉时间真是吝啬。但当自己拥有足够的时间时，却拖延症作祟，什么都不想动，只想坐在那里，什么都不想，让自己放空，但这时内心却是无比挣扎，很想打败拖延症，可是内心总有个懒散的声音在说“好不容易放个假，应该好好休息一下，看什么书啊，多累啊”，好吧，大多数时候总是信了他的话。</p>

<p>后来开始上班，在公司里面接触到了<a href="http://zh.wikipedia.org/wiki/GTD">GTD</a>，也就是一种时间管理方法，它通过将任务记录下来，然后进行整理，再进行检查的方式，来实现集中精力完成正在做的事情。怎么样？听起来很美好吧，这简直就是我的梦想，如果能达到这样的效果，人生该多么美好啊，把每件事情在短时间里做好，你就可以有很多时间去做自己想做的事了。但人生哪有那么容易呢，这里还是回到那个问题---我是拖延症。该怎么让一个拖延症去有效率的做事情呢，还要每天去计划，每天去整理，每天去打勾啊，真是想的太美了。</p>

<p>忘记告诉你了，我喜欢禅学，所以会经常看一些佛学书，在很多书中都提到一句话---“活在当下”，当我第一次看到这句话时，只是轻轻翻过去了，因为实在是太普通的一句话了，但是当这么多本书都在提到时，我觉得我应该好好思考了。“活在当下”是什么呢？其实和GTD的主要目的是一致的，就是专心做好当下这一刻的事。可是禅中的涵义就更深刻多了，我不仅是要做好现在要做的事，还要注重当下的感觉，就像我们总是会去纠结那些自己现在不想做的，却又应该做的事情，这些都是我们对未来未知的不确定。“活在当下”就告诉我们“不要急，先做好现在的事”。为什么这么强调现在？因为现在是过去的未来，是未来的过去，而我们又无法改变过去，而只能通过现在才能改变未来，所以现在才是最重要的。就像佛说“当下是我们唯一拥有的一刻，在当下这一刻快乐地生活，是可以办到的事”。</p>

<p>对于我来说GTD是一个方法，它开始时会给你一些条条框框，你要这样，你要那样，有点让我手足无措，内心无法自由，但当很多人在用了很长时间之后，都可以游刃有余。</p>

<p>所以给自己一点自由，别让自己活在自己营造的压力下，偶尔的拖延症都是可以理解的，我们都不是完美的人，所以当我们没有达到我们想要的程度时，不用着急，给自己一点时间，慢慢积累，努力练习。我一直相信人生是一场慢热积累的过程。所以现在没有成为你想要的样子，也许是你的积分不够吧。</p>
</div>
    <div class="collapse-text"></div>
    <div class="collapse-toggle"></div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-03-13T00:00:00+08:00"><a href="http://morisunshine.com/ios/objc_is_not_what_you_think_it_is/">March 13, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://morisunshine.com/ios/objc_is_not_what_you_think_it_is/#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://morisunshine.com/ios/objc_is_not_what_you_think_it_is/" rel="bookmark" title="Objective-C 不是你想的那样" itemprop="url">Objective-C 不是你想的那样</a></h1>
    
  </header>
  <div class="entry-description"> Ruby 和 Objective-C 这两种语言看上去好像天南地北：一种是动态语言，另一种则是静态语言；一种是解释型语言，另一种是编译型语言；一种有简洁的语法，另一种则是有点冗长的语法。从优雅的角度来看，Ruby似乎更能给我们一种自由的编程体验，所以很多人都放弃了Objective-C。</div>
  <div class="entry-content">
    <div class="full-text"><p>本文由<a href="http://morisunshine.com/">morisunshine</a>译自<a href="http://news.rapgenius.com/Soroush-khanlou-objective-c-isnt-what-you-think-it-is-if-you-think-like-a-rubyist-annotated">&quot;Objective-C isn&#39;t what you think it is&quot;</a>。转载请注明出处！</p>

<hr>

<p>&nbsp;<a href="#message_in_a_bottle"><strong>消息的传递</strong></a><br>
&nbsp;<a href="#getting_metaer_and_metaer"><strong>变得越来越动态</strong></a><br>
&nbsp;<a href="#introspection"><strong>内省</strong></a><br>
&nbsp;<a href="#cashing_in"><strong>现学现用</strong></a><br>
&nbsp;<a href="#what_is_comepielur"><strong>什么是编译器？</strong></a>  </p>

<p>Ruby 和 Objective-C 这两种语言看上去好像天南地北：一种是动态语言，另一种则是静态语言；一种是解释型语言，另一种是编译型语言；一种有简洁的语法，另一种则是有点冗长的语法。从优雅的角度来看，Ruby似乎更能给我们一种自由的编程体验，所以很多人都放弃了Objective-C。</p>

<p>但这是一个不幸的笑话。Objective-C其实并不像别人认为的那样是件紧身衣，它和Ruby一样都受Smalltalk影响，它拥有很多Ruby开发者都喜爱的语言功能–动态方法查找、鸭子类型、开放的类和通常情况下高度可变的runtime等这些功能在Objective-C中同样存在，即使那些不出名的技术也是一样。Objective-C的这些功能都要归功于它的IDE和编译器，但也是因为它们才使你不能自由地编写代码</p>

<p>但是等一下，怎么能说Objective-C是动态语言呢？难道它不是建立在C语言的基础上？</p>

<p>你可以在Objective-C代码中包含任何C或C++的代码，但这不意味着Objective-C仅限于C或C++代码。Objective-C中所有有意思的类操作和对象内省都是来自于一个叫Objective-C Runtime的东西。这个Objective-C Runtime可以和Ruby解释器相媲美。它包含了强大的元编程里所需要的所有重要特性。</p>

<p>其实C语言和Ruby一样是支持这些特性的，用<code>property_getAttributes</code>或<code>method_getImplementation</code>方法就能将selector对应到具体实现(一个selector处理一个方法)，并判断这个对象能否对这个selector做出反应，再遍历子类树。在Objective-C的众多方法中，最重要的就是<code>objc_msgSend</code>方法，是它推动了应用中的每次消息发送。</p>

<hr>

<p><a id='message_in_a_bottle' name='message_in_a_bottle'> </a></p>

<h2>消息的传递</h2>

<p>Smalltalk才是实至名归的第一种面向对象语言，它用“从一个对象发送信息给另一个对象”的新概念取代了“调用函数”的旧概念，对后面的语言发展产生了深远的影响。</p>

<p>你可以在Ruby中通过这样写来实现消息的发送：</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">receiver</span><span class="o">.</span><span class="n">the_message</span> <span class="n">argument</span>
</code></pre></div>
<p>Objective-C的实现方式和Ruby的差不多：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">[</span><span class="n">receiver</span> <span class="nl">theMessage</span><span class="p">:</span><span class="n">argument</span><span class="p">];</span>
</code></pre></div>
<p>这些消息实现了鸭子类型的方式，也就是说关注的不是这个对象的类型或类本身，而是这个对象能否对一个消息做出反应。</p>

<p>发送消息真的是非常棒的事，但是只有当消息在传送数据时，它的价值才会被发挥地更大：</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">receiver</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="ss">:the_message</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
</code></pre></div>
<p>和</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">[</span><span class="n">receiver</span> <span class="nl">performSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">theMessage</span><span class="p">:)</span> 
<span class="nl">withObject</span><span class="p">:</span><span class="n">argument</span><span class="p">];</span>
</code></pre></div>
<p>正如Ruby中方法需要symbol支持一样，Objective-C中selector也需要string来支持。（在Objective-C中没有symbol。）这样就可以让你通过动态的方式使用一个方法。你甚至可以通过<code>NSSelectorFromString</code>方法来使用string创建一个selector，并在一个对象里执行它。同样的，我们可以在Ruby中也可以创建一个string或symbol，并把传给<code>Object#send</code>方法。</p>

<p>当然，无论是哪种语言，一旦你将一个消息发送给不能处理该消息的对象，那么默认情况下就会抛出一个异常，还会导致应用的崩溃。</p>

<p>当你想在调用一个方法前判断一下这个对象是否能够执行这个方法，你可以用Ruby中的<code>respond_to？</code>方法来检查：</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">if</span> <span class="n">receiver</span><span class="o">.</span><span class="n">respond_to?</span> <span class="ss">:the_message</span>
  <span class="n">receiver</span><span class="o">.</span><span class="n">the_message</span> <span class="n">argument</span>
<span class="k">end</span>
</code></pre></div>
<p>Objective-C中也有差不多的方法：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">if</span> <span class="p">([</span><span class="n">receiver</span> <span class="nl">respondsToSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">theMessage</span><span class="p">:)])</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">receiver</span> <span class="nl">theMessage</span><span class="p">:</span><span class="n">someThing</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<hr>

<p><a id='getting_metaer_and_metaer' name='getting_metaer_and_metaer'> </a></p>

<h2>变得越来越动态</h2>

<p>如果你想在一个不能修改的类（像系统类）中添加你想要的方法，那么Objective-C里的category一定不会让你失望 -- 很像Ruby中的“开放类”。</p>

<p>举个例子，如果你想将Rails中的<code>to_sentence</code>方法添加到<code>NSArray</code>类中，我们只需要对<code>NSArray</code>这个类进行扩展就好了：</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">@interface</span> <span class="bp">NSArray</span> <span class="nl">(ToSentence)</span>

<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">toSentence</span><span class="p">;</span>

<span class="k">@end</span>


<span class="k">@implementation</span> <span class="bp">NSArray</span> <span class="nl">(ToSentence)</span>

<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">toSentence</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="p">@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="p">[</span><span class="nb">self</span> <span class="n">lastObject</span><span class="p">];</span>
    <span class="bp">NSArray</span> <span class="o">*</span><span class="n">allButLastObject</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">subarrayWithRange</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)];</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">allButLastObject</span> <span class="nl">componentsJoinedByString</span><span class="p">:@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;];</span>
    <span class="kt">BOOL</span> <span class="n">showComma</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">count</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="nl">stringByAppendingFormat</span><span class="p">:@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span><span class="p">@</span> <span class="n">and</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="n">showComma</span> <span class="o">?</span> <span class="p">@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">:</span> <span class="p">@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;];</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="nl">stringByAppendingString</span><span class="p">:[</span><span class="nb">self</span> <span class="n">lastObject</span><span class="p">]];</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre></div>
<p>Category是在编译的时候将方法添加到程序中 -- 让我们在runtime中动态捕捉它们怎么样？</p>

<p>有些消息可以嵌套数据，就像Rails的dynamic finders。Ruby通过对<code>method_missing</code> 和 <code>respond_to</code>这两个方法的重写，先匹配模式，再将新方法的定义添加到这个对象中。</p>

<p>Objective-C中的流程是差不多，但我们不是重写<code>doesNotRecognizeSelector:</code>方法（相当于Ruby中的<code>method_missing</code>方法），而是在<code>resolveClassMethod:</code>方法中捕捉Category添加的方法。假设我们有一个叫<code>+findWhere:equals:</code>的类方法，它可以得到property的名称和值，那么通过正则表达式就可以很容易实现找到property的名字，并通过block来注册这个selector。</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="p">+</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">resolveClassMethod:</span><span class="p">(</span><span class="kt">SEL</span><span class="p">)</span><span class="nv">sel</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">selectorName</span> <span class="o">=</span> <span class="n">NSStringFromSelector</span><span class="p">(</span><span class="n">sel</span><span class="p">);</span>

    <span class="bp">NSRegularExpression</span> <span class="o">*</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSRegularExpression</span> <span class="nl">regularExpressionWithPattern</span><span class="p">:@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">^</span><span class="n">findWhere</span><span class="p">(</span><span class="err">\\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span><span class="nl">Equals</span><span class="p">:</span><span class="err">$</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="nl">options</span><span class="p">:</span><span class="mi">0</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="bp">NSTextCheckingResult</span> <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">regex</span> <span class="nl">firstMatchInString</span><span class="p">:</span><span class="n">selectorName</span> <span class="nl">options</span><span class="p">:</span><span class="mi">0</span> <span class="nl">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">selectorName</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSRange</span> <span class="n">propertyNameRange</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="nl">rangeAtIndex</span><span class="p">:</span><span class="mi">1</span><span class="p">];</span>
        <span class="bp">NSString</span> <span class="o">*</span><span class="n">propertyName</span> <span class="o">=</span> <span class="p">[</span><span class="n">selectorName</span> <span class="nl">substringWithRange</span><span class="p">:</span><span class="n">propertyNameRange</span><span class="p">];</span>

        <span class="kt">IMP</span> <span class="n">implementation</span>  <span class="o">=</span> <span class="n">imp_implementationWithBlock</span><span class="p">((</span><span class="kt">id</span><span class="p">)</span> <span class="o">^</span><span class="p">(</span><span class="kt">id</span> <span class="nb">self</span><span class="p">,</span> <span class="kt">id</span> <span class="n">arg1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">findWhere</span><span class="p">:</span><span class="n">propertyName</span> <span class="nl">equals</span><span class="p">:</span><span class="n">arg1</span><span class="p">];</span>
        <span class="p">});</span>

        <span class="kt">Class</span> <span class="n">metaClass</span> <span class="o">=</span> <span class="n">object_getClass</span><span class="p">(</span><span class="nb">self</span><span class="p">);</span>

        <span class="n">class_addMethod</span><span class="p">(</span><span class="n">metaClass</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">implementation</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;@@</span><span class="o">:</span><span class="p">@@</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;);</span>
        <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">[</span><span class="nb">super</span> <span class="nl">resolveClassMethod</span><span class="p">:</span><span class="n">sel</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>这个方法的优点就是我们不需要去重写<code>respondsToSelector:</code>，因为每个在类中注册过的selector都会去调用这个方法。现在让我们调用<code>[RGSong findWhereTitleEquals:@“Mercy”]</code>。当<code>findWhereTitleEquals:</code>第一次被调用的时候，runtime并不知道这个方法，所以它会调用<code>resolveClassMethod:</code>，这时我们就将<code>findWhereTitleEquals:</code>这个方法动态添加进去，当第二次调用<code>findWhereTitleEquals:</code>的时候，因为它已经被添加过了，所以就不会再调用<code>resolveClassMethod:</code>了。</p>

<p>这里还有一些别的方法来实现捕捉动态方法。你可以通过重写<code>resolveClassMethod:</code> 和 <code>resolveInstanceMethod:</code>方法（就像上面的一样），可以将消息传递给不同的对象或全权接管这个“调用”，并在消息传递之前，做你想这个消息要完成的任何事。这些方法都会导致运行成本的增加，特别在<code>-forwardInvocation:</code>中会达到顶峰，在这种情况下我们必须要实例化一个对象才能去执行它们。<code>-forwardInvocation:</code>方法中默认调用<code>doesNotRecognizeSelector</code>方法，这导致了应用的频繁异常或崩溃。</p>

<hr>

<p><a id='introspection' name='introspection'> </a></p>

<h2>内省</h2>

<p>动态方法决议并不只是像Ruby和Objective-C这样的语言的技术支持。你也可以通过在runtime中用一种有意思的方式去操作这些对象。</p>

<p>就像在Ruby中调用<code>MyClass#instance_methods</code>一样，你可以在Objective-C中调用<code>class_copyMethodList([MyClass class], &amp;amp;numberOfMethods)</code>来得到一个对象中方法的列表。你还可以通过<code>class_copyPropertyList</code>方法得到一个类中property的列表，它能在你的模型中实现不可思议的内省。比如在这个<code>Rap Genius</code>应用中，我们用这个功能来将JSON中的字典映射到本地对象上。</p>

<p>（如果你非常喜欢Ruby中的mixin，那么Objective-C强大的动态支持也能能实现同样的效果。 Vladimir Mitrovic有一个叫<code>Objective-Mixin</code>的库，它能在runtime时将一个类中的实现复制到另一个类中。）</p>

<hr>

<p><a id='cashing_in' name='cashing_in'> </a></p>

<h2>现学现用</h2>

<p>所有的动态工具都可以用来创建像Core Data这样的东西，Core Data是一个有点像ActiveRecord的持久化对象图。在Core Data中，relationship是“有缺陷的”，也就是说他们只有在被别的对象访问时，才会被加载。每个property的accessor和mutator在runtime中都被重写（使用的就是我们上面提到的动态方法决议）。如果我们访问了一个还没有被加载的对象时，框架就会从持久性储存中动态加载这个对象并将它返回。它保持了内存的低利用率，避免了在任何一个物体被获取时，实体对象图表都要被加载到内存中这样情况的发生。</p>

<p>当Core Data实体中的mutator被调用时，系统会将那个对象标记为需要清理，不需要去重写每个property的getter和setter。</p>

<p>这就是元程序，羡慕吧！</p>

<hr>

<p><a id='what_is_comepielur' name='what_is_comepielur'> </a></p>

<h2>什么是编译器？</h2>

<p>很明显，Objective-C和Ruby并不是同一种语言，目前为止最大的不同就是Objective-C是一种编译型语言。</p>

<p>这就是这些技术中最需要注意的地方。在编译时，编译器会先确定你应用使用的每个selector是不是都在应用中。如果你处理的这个对象有类型信息，那么编译器也会检查确保这个selector在头文件有声明过，这样做就是为了防止在对象中调用未声明的selector。有些方法可以绕过这些讨厌的限制，包括关闭相关的编译警告。这里就是实践元程序化的Objective-C最好的练习。</p>

<p>你可以通过将selector的类型储存为不知道的类型或<code>id</code>来从对象中删除这些类型信息。因为编译器不认识这个类型，所以它只能假设你的程序可以接受发给它的任何消息（假设这些消息在应用中的其他地方被声明了，并且相关的编译标识已经打开）。</p>

<p>善意的忠告：如果我们关掉编译器标识和把对象保存成<code>id</code>类型，那么将会非常危险的事！其实Objective-C中最好的东西之一就是编译器（是的，比元程序还要好）。类型检查保证了我们更快的写和重构代码，也是我们在编程时少犯错误。因为没有人会关掉那些警告，所以你很难去分享你那些<code>id</code>类型的代码。大部分Objective-C开发者还是更愿意使用更强的类型而不是元程序。</p>

<p>事实证明Objective-C更受束缚--但因为编译器能提高更多的安全性和速度，所以我们只能选择这样并承担后果。</p>

<p>事实再次告诉我们，这些语言都是差不多的，Ruby开发者应该享受Objective-C，即使那些中括号让我们望而却步。</p>
</div>
    <div class="collapse-text"></div>
    <div class="collapse-toggle"></div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-03-06T00:00:00+08:00"><a href="http://morisunshine.com/develop/experience_of_develop/">March 06, 2014</a></time></span><span class="author vcard"><span class="fn"><a href="http://morisunshine.com/about/" title="About Sheldon">Sheldon</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://morisunshine.com/develop/experience_of_develop/#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://morisunshine.com/develop/experience_of_develop/" rel="bookmark" title="我的开发经验漫谈" itemprop="url">我的开发经验漫谈</a></h1>
    
  </header>
  <div class="entry-description">工作快一年了，参与了一些项目，在项目有崩溃的时候，也有欣喜的时候，我觉得很有必要记录下来，其中，可能是一些理想的化的设想，因为在之前的开发过程并没有实践过，但我觉得是可以一试，并且是有帮助的。 很多次，我都迫不及待地想马上编写代码，我太喜欢那种写代码的感觉了。可是，越写越觉得不对劲，或者写到一半发现这个功能与需求不一样，然后改了又改，或直接重新开始写。</div>
  <div class="entry-content">
    <div class="full-text"><p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#begin"><strong>项目开始之前</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#specification"><strong>规范</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code_specification"><strong>代码规范</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#version_specification"><strong>版本控制规范</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#document_specification"><strong>文档规范</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#test_specification"><strong>测试规范</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tidy"><strong>整理</strong></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#summary"><strong>总结</strong></a>  </p>

<p>工作快一年了，参与了一些项目，在项目有崩溃的时候，也有欣喜的时候，我觉得很有必要记录下来，其中，可能是一些理想的化的设想，因为在之前的开发过程并没有实践过，但我觉得是可以一试，并且是有帮助的。</p>

<p><a id='begin' name='begin'> </a></p>

<h2>项目开始之前</h2>

<p>很多次，我都迫不及待地想马上编写代码，我太喜欢那种写代码的感觉了。可是，越写越觉得不对劲，或者写到一半发现这个功能与需求不一样，然后改了又改，或直接重新开始写。<br>
所以，不要急，慢慢来，我们可以先用Mind Map，或者你喜欢的方式将需求分析一下，并对一些功能进行细化。<br>
有大概的了解之后，我就该去考虑每个功能的具体实现，这个功能的难点在哪里，用什么方法比较好，如果没有找到好的方法，可以用现有的方法去代替。
在上面都考虑好了，我们就该往大的方面想，用什么样的方式比较好，或许用到什么框架，设计模式比较好。<br>
也许刚开始的时候，我的经验有限，想到的方法或方式非常有限，但是一旦我开始去考虑这些问题，并且去实践的时候，我对这些方法的考虑开始往全面的方向发展，这就是在积累中成长吧。</p>

<hr>

<p><a id='specification' name='specification'> </a></p>

<h2>规范</h2>

<p>当我看过去写的代码，真的有种不想认自己的娃的冲动啊，根本不知道在写什么，命名非常幼稚，当然，现在可能也还是这样，但现在应该有一部分已经成年了吧。很多人会觉得规范是件很麻烦的事，因为规范会给限制程序员的自由，但个人觉得规范与自由并没有冲突。规范应该是团队之间的一种的约定的事情，它的目的是为了能够减少因代码问题而导致的沟通成本。</p>

<p>规范体现在那些地方呢？</p>

<p><a id='code_specification' name='code_specification'> </a></p>

<h3>代码规范</h3>

<p>我觉得每个团队之间的代码规范应该是不一样，代码规范应该是由团队中的每个成员讨论出来的结果，而不是一个人拍案决定，代码规范的目的应该是让你和每个成员都能很好的阅读，把时间专注到更需要时间的地方。<br>
哪些需要规范呢?<br>
比如在iOS项目开发中，就可以有文件名的规范，图片名的规范，类名的规范等。这些命名都需要考虑仔细，因为它不是为一个人而起的。你还要确保别人也能看懂它的作用，也许你会觉得注释就好，当然，这会是个好办法，但如果只要能看到名字就能知道它的功能，那不是更好么？</p>

<p><a id='version_specification' name='version_specification'> </a></p>

<h3>版本控制规范</h3>

<p>版本控制在开发过程中非常重要，所以版本控制的规范也是非常重要的，以git为例:</p>

<ul>
<li>创建的分支名，就应该清楚让人知道我们在这个分支里做了哪些事情。</li>
<li>commit，每一条commit都应该清楚的描述，不能马虎，这不只帮助你未来的查看，也是让开发人员了解代码演化的重要途径之一，另一方面，也不知不觉中养成细化功能的习惯，这样在以后地开发中，你就会对要开发的功能进行细分，当一个子功能开发完成，就写一个commit。(这里可以参考<a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit">google开源项目的commit规范</a>)</li>
</ul>

<p><a id='document_specification' name='document_specification'> </a></p>

<h3>文档规范</h3>

<p>当开始一个项目时，应该需要一个文档，来跟踪你的项目，其中的内容应该包括，这个项目的文件结构，功能，还有一些类的功能。这些也是对代码可读性的扩展。</p>

<p>这么多规范很烦吧，程序员的自由在哪儿，但我觉得我们不只是为现在写程序，很多时候，写程序的时间只占开发整个项目的10%，而很多时间都是在测试，调试，解决bug，或者在寻找以前的代码。所以我们要为未来而写，这对于我来说也是一种自我修养吧。</p>

<p><a id='test_specification' name='test_specification'> </a></p>

<h3>测试规范</h3>

<p>测试，听上去很美好，当在我的以往项目中，这总是被遗忘的事情，或者是根本不会提起的事情，只有当问题产生，才会悔不当初，有它该多好。每次下定决心，一定要写一个测试的时候，总是懒于去行动，但励志要成为优秀工程师的我们一定不会忽略它的，所以测试的规范，也是非常重要的，它也让你知道一这段测试的功能与该有的结果，这也是对功能性的一个很好的补充，也为以后的改动带来了很多方便。</p>

<hr>

<p><a id='tidy' name='tidy'> </a></p>

<h2>整理</h2>

<p>你的项目不会是一尘不变的，他会因为时间的推移而增加更多东西，这时也许你之前的那些管理方式就变得很没有效率，想重新捣腾它，发现牵一发而动全身，真抓狂，早干嘛去了。为了避免这样的悲剧再次重演整理就变得很重要了，整理包括目录结构、资源和代码的整理，文件结构可以参考这篇<a href="http://blog.jobbole.com/61083/">博文</a>,资源和代码整理则是根据上面提到的各种规范，整理的目的应该是让项目清晰和简洁。</p>

<hr>

<p><a id='summary' name='summary'> </a></p>

<h2>总结</h2>

<p>写了这么多，其实也是对自己过去的经验的整理，也是对自己的勉励，博客的意义在于分享，而分享又是为了更好的交流，希望能提出一些宝贵的意见，让我们一起成长。</p>
</div>
    <div class="collapse-text"></div>
    <div class="collapse-toggle"></div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<style type="text/css">body {background-image:url(/images/witewall_3.png);}</style>

<div class="pagination">
  
    
      <a href="http://morisunshine.com" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://morisunshine.com">1</a>
      
    </li>
    
      <li>
        
          <span class="current-page">2</span>
        
      </li>
    
      <li>
        
          <a href="http://morisunshine.com/page3">3</a>
        
      </li>
    
  </ul>
  
    <a href="http://morisunshine.com/page3" class="btn">Next</a>
  
</div><!-- /.pagination -->
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Sheldon. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://morisunshine.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://morisunshine.com/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-47868064-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script src="/assets/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

          


</body>
</html>